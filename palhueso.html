<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pa'l Hueso | Herramienta de Ensayo - Alter.Lab</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        alter: {
                            bg: '#0F121B',
                            cyan: '#00E5FF',
                            dark: '#1a1d26',
                            glass: 'rgba(255, 255, 255, 0.05)'
                        }
                    },
                    fontFamily: {
                        sans: ['Montserrat', 'sans-serif'],
                        mono: ['Inter', 'monospace'],
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-out',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0', transform: 'translateY(10px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        :root {
            --background-color: #0F121B;
            --text-color: #FFFFFF;
            --accent-color: #00E5FF;
        }

        body {
            background-color: var(--background-color);
            color: var(--text-color);
            font-family: 'Montserrat', sans-serif;
            overflow-x: hidden;
        }

        /* Canvas de fondo */
        #canvas-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }

        /* Glassmorphism Cards */
        .glass-card {
            background: rgba(15, 18, 27, 0.85);
            backdrop-filter: blur(16px);
            border: 1px solid rgba(0, 229, 255, 0.15);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.5);
        }

        .glass-card-header {
            background: linear-gradient(90deg, rgba(0,229,255,0.15) 0%, rgba(0,0,0,0) 100%);
            border-bottom: 1px solid rgba(0, 229, 255, 0.1);
        }

        /* Inputs & Selects */
        select, .custom-radio, .btn-control {
            background-color: rgba(0, 0, 0, 0.6);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s;
        }
        select:focus, .btn-control:hover {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 15px rgba(0, 229, 255, 0.25);
        }
        select option {
            background-color: #0F121B;
        }

        /* Chips de notas */
        .note-chip {
            display: inline-block;
            padding: 0.35rem 0.85rem;
            margin: 0.25rem;
            border-radius: 9999px;
            font-size: 0.95rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        .main-note {
            background-color: rgba(0, 229, 255, 0.1);
            color: #00E5FF;
            border: 1px solid rgba(0, 229, 255, 0.5);
            text-shadow: 0 0 5px rgba(0, 229, 255, 0.5);
        }
        .passing-note {
            background-color: rgba(255, 171, 0, 0.1); 
            color: #ffab00;
            border: 1px dashed #ffab00;
        }

        /* --- DIAGRAMAS HOLOGRÁFICOS --- */
        #guitar-diagram-svg .fret-line { stroke: rgba(255,255,255,0.3); stroke-width: 2; }
        #guitar-diagram-svg .string { stroke: rgba(0, 229, 255, 0.2); stroke-width: 1; }
        #guitar-diagram-svg .nut { fill: rgba(0, 229, 255, 0.5); }
        #guitar-diagram-svg .note-dot { fill: #00E5FF; stroke: #fff; stroke-width: 1px; filter: drop-shadow(0 0 4px #00E5FF); }

        #piano-diagram-svg .white-key { fill: rgba(255, 255, 255, 0.03); stroke: rgba(0, 229, 255, 0.3); stroke-width: 1; }
        #piano-diagram-svg .black-key { fill: rgba(0,0,0,0.8); stroke: rgba(0, 229, 255, 0.2); stroke-width: 1; }
        #piano-diagram-svg .highlight-key { fill: rgba(0, 229, 255, 0.8); filter: drop-shadow(0 0 6px #00E5FF); }

        /* Estilos de Letras */
        .lyrics-container {
            white-space: pre-wrap;
            font-family: 'Inter', monospace;
            line-height: 1.8;
        }
        .chord-highlight {
            color: #00E5FF;
            font-weight: bold;
            background: rgba(0, 229, 255, 0.1);
            padding: 2px 6px;
            border-radius: 4px;
            margin: 0 2px;
            box-shadow: 0 0 5px rgba(0, 229, 255, 0.1);
        }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #0F121B; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #00E5FF; }
    </style>
</head>
<body class="min-h-screen flex flex-col justify-between">

    <div id="canvas-container"></div>

    <header class="w-full py-6 z-10 relative">
        <div class="container mx-auto px-4 flex flex-col items-center">
            <a href="index.html" class="flex items-center gap-3 mb-2 animate-fade-in hover:opacity-80 transition-opacity group">
                <svg class="w-8 h-8 text-alter-cyan filter drop-shadow-[0_0_8px_rgba(0,229,255,0.8)] group-hover:scale-110 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"></path></svg>
                <span class="logo-text font-bold text-xl md:text-2xl text-white tracking-[0.2em]">ALTER.LAB</span>
            </a>
            <div class="h-0.5 w-24 bg-alter-cyan shadow-[0_0_15px_#00E5FF] rounded-full"></div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-8 z-10 relative flex-grow max-w-7xl">
        
        <div class="text-center mb-12 animate-fade-in">
            <h1 class="text-5xl md:text-7xl font-bold mb-4 tracking-tighter text-transparent bg-clip-text bg-gradient-to-br from-white via-alter-cyan to-gray-400" style="text-shadow: 0 0 30px rgba(0,229,255,0.2);">
                Pa'l Hueso
            </h1>
            <p class="text-gray-400 text-lg md:text-xl font-light tracking-widest uppercase">
                La herramienta para no perder más tiempo en los ensayos
            </p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
            
            <div class="lg:col-span-5 space-y-8">
                
                <div class="glass-card rounded-xl p-6 animate-fade-in" style="animation-delay: 0.1s;">
                    <div class="space-y-6">
                        <div>
                            <label for="song-selector" class="block text-sm font-bold text-alter-cyan mb-2 uppercase tracking-wider">
                                <i class="bi bi-music-note-beamed mr-2"></i>Selecciona la Pieza
                            </label>
                            <select id="song-selector" onchange="updateAnalysis()" class="w-full p-3 rounded-lg text-white focus:ring-2 focus:ring-alter-cyan transition-all cursor-pointer">
                                <option value="" disabled selected>-- Repertorio Cargado --</option>
                                </select>
                        </div>

                        <div>
                            <label class="block text-sm font-bold text-alter-cyan mb-2 uppercase tracking-wider">
                                <i class="bi bi-person-badge mr-2"></i>Instrumento
                            </label>
                            <div class="flex flex-wrap gap-2 p-3 rounded-lg bg-black/20 border border-white/10">
                                <label class="flex items-center cursor-pointer hover:text-alter-cyan transition-colors group mr-4">
                                    <input type="radio" name="instrument" value="Concert" checked onchange="updateAnalysis()" class="mr-2 accent-alter-cyan w-4 h-4">
                                    <span class="text-sm group-hover:translate-x-1">Concierto (C)</span>
                                </label>
                                <label class="flex items-center cursor-pointer hover:text-alter-cyan transition-colors group mr-4">
                                    <input type="radio" name="instrument" value="Bb" onchange="updateAnalysis()" class="mr-2 accent-alter-cyan w-4 h-4">
                                    <span class="text-sm group-hover:translate-x-1">Sax Tenor (B♭)</span>
                                </label>
                                <label class="flex items-center cursor-pointer hover:text-alter-cyan transition-colors group">
                                    <input type="radio" name="instrument" value="Eb" onchange="updateAnalysis()" class="mr-2 accent-alter-cyan w-4 h-4">
                                    <span class="text-sm group-hover:translate-x-1">Sax Alto (E♭)</span>
                                </label>
                            </div>
                        </div>

                        <div>
                            <label class="block text-xs font-bold text-yellow-500 mb-2 uppercase flex justify-between">
                                <span>Ajuste Manual (+/- Semitonos)</span>
                                <span id="pitch-val" class="bg-yellow-500/20 px-2 rounded text-yellow-500">0</span>
                            </label>
                            <div class="flex items-center gap-4">
                                <button onclick="changePitch(-1)" class="btn-control w-10 h-10 rounded-full font-bold text-xl">-</button>
                                <div class="flex-grow h-1 bg-gray-700 rounded overflow-hidden">
                                    <div id="pitch-bar" class="h-full bg-yellow-500 w-1/2 transition-all duration-300"></div>
                                </div>
                                <button onclick="changePitch(1)" class="btn-control w-10 h-10 rounded-full font-bold text-xl">+</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="analysis-output" class="hidden space-y-6">
                    
                    <div class="glass-card rounded-xl overflow-hidden animate-fade-in">
                        <div class="glass-card-header p-4 flex justify-between items-center">
                            <h2 class="text-lg font-bold text-white tracking-widest uppercase">
                                <i class="bi bi-cpu-fill mr-2"></i>Harmonic HUD
                            </h2>
                            <span id="instrument-display" class="text-xs font-mono bg-alter-cyan text-black px-2 py-1 rounded font-bold shadow-[0_0_10px_#00E5FF]">CONCERT</span>
                        </div>
                        
                        <div class="p-6">
                            <div class="mb-6 text-center">
                                <p class="text-xs text-gray-400 uppercase tracking-[0.3em] mb-2">Tonalidad Transpuesta</p>
                                <p id="transposed-key" class="text-6xl font-black text-white filter drop-shadow-[0_0_15px_rgba(0,229,255,0.4)]"></p>
                            </div>

                            <div class="bg-gray-900/40 rounded-lg p-3 border border-gray-700/50 mb-4">
                                <p class="text-xs text-alter-cyan uppercase tracking-wider mb-2 font-bold">Progresión Base</p>
                                <div class="font-mono text-lg text-gray-200 overflow-x-auto whitespace-nowrap">
                                    <span id="transposed-chords"></span>
                                </div>
                            </div>
                            
                            <div class="bg-gray-900/40 rounded-lg p-3 border border-gray-700/50">
                                <p class="text-xs text-alter-cyan uppercase tracking-wider mb-2 font-bold">Escala</p>
                                <div class="font-mono text-lg text-gray-200"><span id="transposed-scale"></span></div>
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-2 gap-4 animate-fade-in">
                         <div class="glass-card rounded-xl p-4 border-l-2 border-l-alter-cyan flex flex-col items-center">
                            <h3 class="text-xs font-bold text-gray-300 mb-2 w-full text-center">
                                <i class="bi bi-guitar mr-1 text-alter-cyan"></i>Gtr Tonic
                            </h3>
                            <div class="w-full max-w-[150px]">
                                <svg id="guitar-diagram-svg" viewBox="0 0 200 150" class="w-full h-auto" xmlns="http://www.w3.org/2000/svg"></svg>
                            </div>
                            <p id="guitar-chord-name" class="text-xs font-bold mt-2 text-alter-cyan"></p>
                        </div>

                        <div class="glass-card rounded-xl p-4 border-l-2 border-l-purple-500 flex flex-col items-center">
                            <h3 class="text-xs font-bold text-gray-300 mb-2 w-full text-center">
                                <i class="bi bi-keyboard mr-1 text-purple-400"></i>Keys Tonic
                            </h3>
                            <div class="w-full max-w-[180px]">
                                <svg id="piano-diagram-svg" viewBox="0 0 350 120" class="w-full h-auto" xmlns="http://www.w3.org/2000/svg"></svg>
                            </div>
                            <p id="piano-chord-name" class="text-xs font-bold mt-2 text-purple-400"></p>
                        </div>
                    </div>

                    <div class="glass-card p-5 rounded-xl">
                        <h3 class="text-sm font-bold text-white mb-3 border-b border-white/10 pb-2">Notas Seguras (Improvisación)</h3>
                        <div id="scale-notes-container" class="flex flex-wrap gap-2"></div>
                    </div>
                    
                    <div class="glass-card rounded-xl p-6 animate-fade-in border-l-4 border-l-yellow-500">
                        <h3 class="text-lg font-bold mb-3 text-yellow-500 uppercase tracking-wider"><i class="bi bi-lightbulb-fill mr-2"></i>Tips</h3>
                        <p id="execution-advice" class="text-gray-300 leading-relaxed font-mono text-sm"></p>
                    </div>
                </div>
            </div>

            <div class="lg:col-span-7 space-y-8">
                
                <div id="initial-message" class="glass-card p-12 text-center text-gray-500 rounded-xl animate-fade-in h-full flex flex-col justify-center items-center min-h-[400px]">
                    <i class="bi bi-vinyl-fill text-6xl mb-6 block text-gray-700/50"></i>
                    <p class="text-lg font-medium">Selecciona una canción y ajusta tu instrumento para cargar la data.</p>
                </div>

                <div id="right-panel-content" class="hidden h-full">
                    <div class="glass-card rounded-xl p-6 animate-fade-in relative overflow-hidden h-full flex flex-col">
                        <div class="absolute top-0 right-0 p-4 opacity-10 pointer-events-none">
                            <i class="bi bi-file-music-fill text-8xl text-alter-cyan"></i>
                        </div>
                        <div class="flex justify-between items-center border-b border-gray-700 pb-4 mb-4">
                            <h3 class="text-xl font-bold text-white flex items-center">
                                <i class="bi bi-mic-fill mr-2 text-alter-cyan"></i>Letra y Acordes
                            </h3>
                            <div id="critical-chord-section" class="hidden">
                                <span class="text-xs bg-red-900/40 text-red-200 px-3 py-1 rounded-full border border-red-500/30">
                                    <i class="bi bi-exclamation-triangle-fill mr-1"></i>Crítico: <span id="critical-chord-advice" class="font-bold"></span>
                                </span>
                            </div>
                        </div>
                        
                        <div class="lyrics-container text-gray-300 text-sm md:text-base overflow-y-auto pr-2 flex-grow custom-scrollbar" id="lyrics-content" style="max-height: 70vh;">
                            </div>
                    </div>
                </div>

            </div>
        </div>
    </main>

    <footer class="relative z-10 py-8 mt-12 border-t border-gray-800 bg-gray-900/80 backdrop-blur-md">
        <div class="container mx-auto text-center">
            <p class="text-gray-600 text-xs uppercase tracking-widest">© 2025 Alter.Lab | Generative Art & Code</p>
        </div>
    </footer>

    <script>
        const NOTES = ["C", "C#", "D", "D#", "E", "F", "F#", "G", "G#", "A", "A#", "B"];
        const ENHARMONICS = { "C#": "Db", "D#": "Eb", "F#": "Gb", "G#": "Ab", "A#": "Bb", "Db": "C#", "Eb": "D#", "Gb": "F#", "Ab": "G#", "Bb": "A#" };
        
        const SCALE_STEPS = {
            'Jónica': [0, 2, 4, 5, 7, 9, 11], 
            'Eólica': [0, 2, 3, 5, 7, 8, 10], 
            'Dórica': [0, 2, 3, 5, 7, 9, 10], 
            'Armónica': [0, 2, 3, 5, 7, 8, 11],
            'Pentatónica': [0, 3, 5, 7, 10], 
            'Mayor': [0, 2, 4, 7, 9], 
            'Mixolidia': [0, 2, 4, 5, 7, 9, 10],
            'Blues': [0, 3, 5, 6, 7, 10],
            'Natural': [0, 2, 4, 5, 7, 9, 11],
            'Lidia': [0, 2, 4, 6, 7, 9, 11]
        };

        const CHORD_INTERVALS = {
            'm': [0, 3, 7], 'maj7': [0, 4, 7, 11], 'm7': [0, 3, 7, 10], 
            '7': [0, 4, 7, 10], 'M': [0, 4, 7], 'dim': [0, 3, 6], 'sus4': [0, 5, 7]
        };

        const GUITAR_TUNING = [4, 9, 2, 7, 11, 4]; // E A D G B E

        // --- DATOS COMPLETOS DE CANCIONES (CON LETRAS) ---
        const SONGS_DATA = {
            'up-around-the-bend': { title: 'Up Around the Bend (CCR)', concertKey: 'D', baseChords: 'D–A–G', improvScale: 'D Mayor Pentatónica', advice: 'Corrección: La tonalidad original es Re (D), no La. El riff de apertura usa cuerdas al aire (D y A) para crear ese sonido de "gaita". El ataque debe ser agresivo.', criticalChord: 'A7 (V)', chordType: 'M', steps: SCALE_STEPS['Mayor'], lyrics: `[Intro]\n(Riff en D Mayor)\n\n[Verso 1]\nThere's a place up ahead and I'm [A]goin'\nJust as fast as my feet can fly\nCome away, come away if you're [A]goin'\nLeave the sinkin' ship behind\n\n[Estribillo]\n[G]C'mon the risin'wind\n[G]We're goin' up around the [A]bend\n[A7]Ooh!\n\n[Verso 2]\nBring a song and a smile for the [A]banjo\nBetter get while the gettin's good\nHitch a ride to the end of the [A]highway\nWhere the neons turn to wood\n\n[Estribillo]\n[G]C'mon the risin'wind\n[G]We're goin' up around the [A]bend\n[A7]Yeah!\n\n\n| D | D | A | D |\n| D | D | A | D |\n\n[Verso 3]\nYou can ponder perpetual [A]motion\nFix your mind on a crystal day\nAlways time for a good conver-[A]sation\nThere's an ear for what you say\n\n[Estribillo]\n[G]C'mon the risin'wind\n[G]We're goin' up around the [A]bend\n[A7]Yeah!\n\n[Verso 4]\nCatch a ride to the end of the [A]highway\nAnd we'll meet by the big red tree\nThere's a place up ahead and I'm [A]goin'\nCome along, come along with me\n\n[Estribillo]\n[G]C'mon the risin'wind\n[G]We're goin' up around the [A]bend\n[A7]Yeah!\n\n[Outro]\nDo do doo do...` },
            'born-on-the-bayou': { title: 'Born on the Bayou (CCR)', concertKey: 'E', baseChords: 'E7–D–A', improvScale: 'E Mixolidia / Blues', advice: 'Corrección: El acorde de paso no es B7, sino D y A. Todo gira sobre el E7 "vamp". Usa mucho trémolo en la guitarra.', criticalChord: 'E7#9 (Hendrix Chord)', chordType: '7', steps: SCALE_STEPS['Blues'], lyrics: `[Intro]\n(E7 Vamp - Trémolo lento)\n\n[Verso 1]\n[E7]Now, when I was just a little boy\n[E7]Standin' to my Daddy's knee\n[E7]My poppa said, "Son, don't let the man get you\n[E7]Do what he done to me"\n\n[Estribillo]\n[E7]'Cause he'll get you\n[E7]'Cause he'll get you now, now\n\n[Verso 2]\n[E7]And I can remember the fourth of July\n[E7]Runnin' through the backwood, bare[A]\n[E7]And I can still hear my old hound dog barkin'\n[E7]Chasin' down a hoodoo there[A]\n[E7]Chasin' down a hoodoo there[A]\n\n[Estribillo]\n[E7]Born on the bayou[A]\n[E7]Born on the bayou[A]\n[E7]Born on the bayou[A]\n\n[Verso 3]\n[E7]Wish I was back on the bayou\n[E7]Rollin' with some Cajun queen\n[E7]Wishin' I were a fast freight train\n[E7]Just a chooglin' on down to New Or-leans[A]\n\n[Estribillo]\n[E7]Born on the bayou[A]\n[E7]Born on the bayou[A]\n[E7]Do it, do it, do it!\n\n\n(Escala E Blues sobre E7)\n\n[Verso 4]\n[E7]I can remember the fourth of July\n[E7]Runnin' through the backwood, bare[A]\n[E7]And I can still hear my old hound dog barkin'\n[E7]Chasin' down a hoodoo there[A]\n[E7]Chasin' down a hoodoo there[A]\n\n[Outro]\n[E7]Born on the bayou...` },
            'fortunate-son': { title: 'Fortunate Son (CCR)', concertKey: 'G', baseChords: 'G–F–C–G', improvScale: 'G Mixolidia', advice: 'Clave el movimiento descendente: G -> F -> C -> G. El F natural (bVII) es lo que le da el carácter rebelde y Mixolidio.', criticalChord: 'F (bVII)', chordType: 'M', steps: SCALE_STEPS['Mixolidia'], lyrics: `[Intro]\n[G][F][C][G]\n\n[Verso 1]\n[G]Some folks are born [F]made to wave the flag\n[C]Ooh, they're red, white and [G]blue\n[G]And when the band plays [F]"Hail to the chief"\n[C]Ooh, they point the cannon at [G]you, Lord\n\n[Estribillo]\n[G]It ain't me, it ain't me\n[C]I ain't no senator's [G]son, son\n[G]It ain't me, it ain't me\n[C]I ain't no fortunate [G]one, no\n\n[Verso 2]\n[G]Some folks are born [F]silver spoon in hand\n[C]Lord, don't they help them-[G]selves, y'all\n[G]But when the taxman [F]comes to the door\n[C]Lord, the house looks like a rummage [G]sale, yes\n\n[Estribillo]\n[G]It ain't me, it ain't me\n[C]I ain't no millionaire's [G]son, no, no\n[G]It ain't me, it ain't me\n[C]I ain't no fortunate [G]one, no\n\n[Instrumental]\n\n| G | F | C | G |\n| G | F | C | G |\n\n[Verso 3]\n[G]Some folks inherit [F]star spangled eyes\n[C]Ooh, they send you down to [G]war, Lord\n[G]And when you ask 'em, [F]"How much should we give?"\n[C]Ooh, they only answer, "More! More! [G]More!" y'all\n\n[Estribillo]\n[G]It ain't me, it ain't me\n[C]I ain't no military [G]son, son\n[G]It ain't me, it ain't me\n[C]I ain't no fortunate [G]one, one\n[G]It ain't me, it ain't me\n[C]I ain't no fortunate [G]one, no, no, no\n[G]It ain't me, it ain't me\n[C]I ain't no fortunate [G]son, no, no, no` },
            'get-back': { title: 'Get Back (The Beatles)', concertKey: 'A', baseChords: 'A–G–D–A', improvScale: 'A Mixolidia', advice: 'Ritmo "Pony" (galope). El acorde D7/A en el estribillo crea la tensión. El solo es puramente pentatónico menor sobre acordes mayores.', criticalChord: 'G (bVII)', chordType: 'M', steps: SCALE_STEPS['Mixolidia'], lyrics: `[Intro]\n(Ritmo en A)\n\n[Verso 1]\n[A]Jojo was a man who thought he was a loner\n[A]But he knew it couldn't last\n[A]Jojo left his home in Tucson, Arizona\n[A]For some California grass\n\n[Estribillo]\n[A]Get back, get back\n[A]Get back to where you once be-longed\n[A]Get back, get back\n[A]Get back to where you once be-longed\n(Get back Jojo)\n\n\n| A | A | D | A |\n| A | A | D | A |\n\n[Verso 2]\n[A]Sweet Loretta Martin thought she was a woman\n[A]But she was another man\n[A]All the girls around her say she's got it coming\n[A]But she gets it while she can\n\n[Estribillo]\n[A]Get back, get back\n[A]Get back to where you once be-longed\n[A]Get back, get back\n[A]Get back to where you once be-longed\n(Get back Loretta)\n\n\n| A | A | D | A |\n\n[Estribillo]\n[A]Get back, get back\n[A]Get back to where you once be-longed\n[A]Get back, get back\n[A]Get back to where you once be-longed\n\n[Outro]\n[A]Get back Loretta...\n[A]Your mommy's waiting for you...\n[A]Wearing her high-heel shoes and her low-neck sweater...\n[A]Get back home, Loretta.` },
            'dreams-fleetwood': { title: 'Dreams (Fleetwood Mac)', concertKey: 'F', baseChords: 'Fmaj7–G6', improvScale: 'F Jónica (Mayor)', advice: 'Corrección: No es Gm7, es G6. La canción oscila solo entre dos acordes: Fmaj7 y G6. La melodía vocal está en La menor, creando una ambigüedad modal.', criticalChord: 'G6', chordType: 'maj7', steps: SCALE_STEPS['Lidia'], lyrics: `[Verso 1]\n[Fmaj7]Now here you go again, you say [G6]you want your freedom\n[Fmaj7]Well, who am I to keep you [G6]down?\n[Fmaj7]It's only right that you should [G6]play the way you feel it\n[Fmaj7]But listen carefully to the [G6]sound\nOf your [Fmaj7]loneliness\n\n[Estribillo]\n[Fmaj7]Like a heartbeat drives you [G6]mad\nIn the [Fmaj7]stillness of remembering what you [G6]had\n[Fmaj7]And what you lost... [G6]\n[Fmaj7]And what you had... [G6]\n[Fmaj7]And what you lost\n\n[Estribillo]\n[Fmaj7]Thunder only happens when it's [G6]raining\n[Fmaj7]Players only love you when they're [G6]playing\n[Fmaj7]Say, women, they will come and they will [G6]go\n[Fmaj7]When the rain washes you clean, you'll [G6]know\nYou'll [Fmaj7]know\n\n[Verso 2]\n[Fmaj7]Now here I go again, I see [G6]the crystal visions\n[Fmaj7]I keep my visions to my-[G6]self\n[Fmaj7]It's only me who wants to [G6]wrap around your dreams and...\n[Fmaj7]Have you any dreams you'd like to [G6]sell?\nDreams of [Fmaj7]loneliness...\n\n[Estribillo]\n[Fmaj7]Like a heartbeat drives you [G6]mad...\n[Fmaj7]Thunder only happens when it's [G6]raining\n[Fmaj7]Players only love you when they're [G6]playing\n[Fmaj7]Say, women, they will come and they will [G6]go\n[Fmaj7]When the rain washes you clean, you'll [G6]know\nYou'll [Fmaj7]know` },
            'dreams-cranberries': { title: 'Dreams (The Cranberries)', concertKey: 'E', baseChords: 'E–A–B', improvScale: 'E Mayor', advice: 'Corrección: La tonalidad original es Mi Mayor (E), no Si menor. Acordes: E, A, B. El puente modula sorpresivamente.', criticalChord: 'G (Intercambio modal)', chordType: 'M', steps: SCALE_STEPS['Mayor'], lyrics: `[Verso 1]\n[E]Oh, my life is changing [A]everyday\nIn every possible [E]way\n[E]And oh, my dreams, it's never quite as it [A]seems\nNever quite as it [E]seems\n\n[Estribillo]\n[E]I know I've felt like this be-[A]fore\nBut now I'm feeling it even [E]more\n[E]Because it came from [A]you\n[A]Then I open up and [E]see\n[E]The person falling here is [A]me\nA different way to [E]be\n\n[Puente]\n[G]La, la-la, la-la, la [C]la...\n[G]La, la-la, la-la, la [C]la...\n\n[Verso 2]\n[E]I want more, impossible to ig-[A]nore\nImpossible to ig-[E]nore\n[E]And they'll come true, impossible not to [A]do\nImpossible not to [E]do\n\n[Estribillo]\n[E]And now I tell you open-[A]ly\nYou have my heart so don't hurt [E]me\n[E]You're what I couldn't [A]find\nA totally amazing [E]mind\n[E]So understanding and so [A]kind\nYou're everything to [E]me\n\n[Outro]\n[E]Oh, my life is changing [A]everyday\nIn every possible [E]way...` },
            'tin-man': { title: 'Tin Man (America)', concertKey: 'G', baseChords: 'Gmaj7–Cmaj7', improvScale: 'G Mayor', advice: 'Corrección: La magia está en las extensiones Maj7. El coro usa Am7 y Bm7 (o Em7 según la inversión). George Martin produjo esto, busca la suavidad acústica.', criticalChord: 'Cmaj7', chordType: 'maj7', steps: SCALE_STEPS['Mayor'], lyrics: `[Intro]\n[Gmaj7][Cmaj7] (x2)\n\n[Verso 1]\n[Gmaj7]Sometimes late when things are real\n[Cmaj7]And people share the gift of gab between themselves\n[Gmaj7]Some are quick to take the bait\n[Cmaj7]And catch the perfect prize that waits among the shelves\n\n[Estribillo]\n[Am7]But Oz never did give nothing to the [Gmaj7]Tin Man\n[Am7]That he didn't, didn't already [Gmaj7]have\n[Am7]And Cause never was the reason for the [Gmaj7]evening\n[Am7]Or the tropic of Sir Gala-[Gmaj7]had\n\n[Puente]\nSo please believe inme\n\n[Verso 2]\n[Gmaj7]When I say I'm spinning round, round, round, round\n[Cmaj7]Smoke glass stain bright color, image going down, down, down, down\n[Gmaj7]Soap suds green like [Cmaj7]bubbles\n\n[Estribillo]\n[Am7]But Oz never did give nothing to the [Gmaj7]Tin Man\n[Am7]That he didn't, didn't already [Gmaj7]have\n[Am7]And Cause never was the reason for the [Gmaj7]evening\n[Am7]Or the tropic of Sir Gala-[Gmaj7]had\n\n[Outro]\nSo please believe inme\n[Gmaj7]Ohh, [Cmaj7]ohh...` },
            'everybody-wants-to-rule': { title: 'Everybody Wants to Rule the World (Tears for Fears)', concertKey: 'D', baseChords: 'D–G/D–A/D', improvScale: 'D Mixolidia', advice: 'El bajo (D) se mantiene constante en los versos (Pedal Point), creando tensión. El estribillo rompe a Em - F#m.', criticalChord: 'G/D (Pedal)', chordType: 'M', steps: SCALE_STEPS['Mixolidia'], lyrics: `[Intro]\n (Riff de guitarra en D)\n\n[Verso 1]\nWelcome to yourlife\nThere's no turningback\nEven while wesleep\nWe will findyou\n\n[Estribillo]\n[Em]Acting on your [F#m]best behaviour\n[G]Turn your back on [F#m]mother nature\n[Em]Every-[F#m]body [G]wants to [A]rule theworld\n\n[Verso 2]\nIt's my own de-sign\nIt's my own re-morse\nHelp me to de-cide\nHelp me make themost of freedom and of pleasure\n[G]Nothing ever [F#m]lasts forever\n[Em]Every-[F#m]body [G]wants to [A]rule theworld\n\n[Puente]\n[G]There's a room where thelight won't [A]find you\n[G]Holding hands while thewalls come [A]tumbling down\n[G]When they do I'll beright be-[A]hind you\n\n[Estribillo]\n[Em]So glad we've [F#m]almost made it\n[G]So sad they [F#m]had to fade it\n[Em]Every-[F#m]body [G]wants to [A]rule theworld` },
            'overkill': { title: 'Overkill (Men at Work)', concertKey: 'D', baseChords: 'D–A–C–G', improvScale: 'D Mixolidia', advice: 'Corrección: Tonalidad original D (acústica) o E (estudio). Progresión clave: D - A - C - G (bajada cromática del bajo implícita). El solo de saxo es legendario.', criticalChord: 'C (bVII)', chordType: 'M', steps: SCALE_STEPS['Mixolidia'], lyrics: `[Verso 1]\nI can't get to [A]sleep\n[C]I think about the impli-[G]cations\nOf diving in too [A]deep\n[C]And possibly the compli-[G]cations\n\n[Verso 2]\nEspecially at [A]night\n[C]I worry over situ-[G]ations\nI know will be al-[A]right\n[C]Perhaps it's just imagi-[G]nation\n\n[Estribillo]\nDay after day it reappe-[A]ars\nNight after night my heartbeat shows the [A]fear\n[F#sus4]Ghosts ap-[F#]pear and fade a-[G]way\n[F#sus4]Ghosts ap-[F#]pear and fade a-[G]way\n\n[Verso 3]\nAlone between the [A]sheets\n[C]Only brings exaspe-[G]ration\nIt's time to walk the [A]streets\n[C]Smell the desper-[G]ation\n\n[Verso 4]\nAt least there's pretty [A]lights\n[C]And though there's little vari-[G]ation\nIt nullifies the [A]night\n[C]From over-[G]kill\n\n[Estribillo]\nDay after day it reappe-[A]ars\nNight after night my heartbeat shows the [A]fear\n[F#sus4]Ghosts ap-[F#]pear and fade a-[G]way` },
            'hold-the-line': { title: 'Hold the Line (Toto)', concertKey: 'F#m', baseChords: 'F#m–C#m–D–E', improvScale: 'F# Menor / Pentatónica', advice: 'Corrección: La tonalidad es Fa sostenido menor (F#m). El piano lleva tresillos constantes. La progresión es F#m - C#m - D - E.', criticalChord: 'C#m (v)', chordType: 'm', steps: SCALE_STEPS['Eólica'], lyrics: `[Intro]\n[F#m][C#m][E] (Riff de piano en tresillos)\n\n[Verso 1]\n[F#m]It's not in the [C#m]way that you hold me[E]\n[F#m]It's not in the [C#m]way you say you care[E]\n[F#m]It's not in the [C#m]way you've been treating my friends[E]\n[F#m]It's not in the [C#m]way that you stayed 'til the end[E]\n[F#m]It's not in the [C#m]way you look or the things that you say that you'lldo [E]\n\n[Estribillo]\n[F#m]Hold the [C#m]line\n[E]Love isn't always on [F#m]time [C#m][E]\n[F#m]Hold the [C#m]line\n[E]Love isn't always on [F#m]time [C#m][E]\n\n[Verso 2]\n[F#m]It's not in the [C#m]words that you told me[E]\n[F#m]It's not in the [C#m]way you say you're mine[E]\n[F#m]It's not in the [C#m]way that you came back to me[E]\n[F#m]It's not in the [C#m]way that your love set me free[E]\n[F#m]It's not in the [C#m]way you look or the things that you say that you'lldo [E]\n\n[Estribillo]\n[F#m]Hold the [C#m]line\n[E]Love isn't always on [F#m]time [C#m][E]` },
            'baby-come-back': { title: 'Baby Come Back (Player)', concertKey: 'Cm', baseChords: 'Abmaj7–Gm7–Cm7–Fm7', improvScale: 'C Menor Natural', advice: 'Yacht Rock clásico. Acordes extendidos. El estribillo usa Abmaj7 para ir bajando suavemente a Cm7. El puente modula.', criticalChord: 'Abmaj7 (bVI)', chordType: 'maj7', steps: SCALE_STEPS['Eólica'], lyrics: `[Intro]\n[Abmaj7][Gm7][Cm7][Fm7]\n\n[Verso 1]\nSpending all my nights, all my [Gm7]money going out on the town\nDoing anything just to [Gm7]get you off of my mind\nBut when the morning comes, I'm right [Gm7]back where I started again\nTrying to forget you is just a waste of [C]time\n\n[Estribillo]\n[Abmaj7]Baby come back, any [Gm7]kind of fool could [Cm7]see\n[Fm7]There was something in [Gm7]everything a-[Cm7]-bout you\n[Abmaj7]Baby come back, you can [Gm7]blame it all on [Cm7]me\n[Fm7]I was wrong, and I [Gm7]just can't live with-[Cm7]-out you\n\n[Verso 2]\nAll day long, wearing a [Gm7]mask of false bravado\nTrying to keep up the smile that hides a [Gm7]tear\nBut as the sun goes down, I get that [Gm7]empty feeling again\nHow I wish to God that you were [C]here\n\n[Estribillo]\n[Abmaj7]Baby come back...\n\n[Puente]\n[Gbmaj7]Now that I put it all to--gether\n[Gbmaj7]Give me the chance to make yousee\n[Gbmaj7]Have you used up all the love in your [Fm7]heart\nNothing left forme, ain't there nothing left for me?` },
            'shape-of-my-heart': { title: 'Shape of my heart (Sting)', concertKey: 'F#m', baseChords: 'F#m–E6–D6–C#7', improvScale: 'F# Menor', advice: 'Corrección: La tonalidad es F#m. La bajada es diatónica: F#m - E - D - C#sus4 - C#7. La guitarra clásica de Dominic Miller es esencial.', criticalChord: 'C#7 (V)', chordType: 'm', steps: SCALE_STEPS['Eólica'], lyrics: `[Verso 1]\n[F#m]He deals the [C#m]cards as a medi-tation [C#sus4][C#7]\n[F#m]And those he [C#m]plays never sus-pect [C#sus4][C#7]\n[F#m]He doesn't [C#m]play for the money hewins [C#sus4][C#7]\n[F#m]He don't [C#m]play for re-spect [C#sus4][C#7]\n\n[Verso 2]\n[F#m]He deals the [C#m]cards to find theanswer [C#sus4][C#7]\n[F#m]The sacred [C#m]geometry ofchance [C#sus4][C#7]\n[F#m]The hidden [C#m]law of a probableoutcome [C#sus4][C#7]\n[F#m]The numbers [C#m]lead adance [C#sus4][C#7]\n\n[Estribillo]\n[F#m]I know that the [C#m]spades are the swords of asoldier [C#sus4][C#7]\n[F#m]I know that the [C#m]clubs are weapons ofwar [C#sus4][C#7]\n[F#m]I know that [C#m]diamonds mean money for thisart [C#sus4][C#7]\n[F#m]But that's not the [C#m]shape of myheart [C#sus4][C#7]\n[F#m]That's not the [C#m]shape of my [F#m]heart` },
            'michelle': { title: 'Michelle (The Beatles)', concertKey: 'F', baseChords: 'F–Fm–Bb7', improvScale: 'F Mayor / F Menor', advice: 'Usa el intercambio modal entre F Mayor y F Menor. El acorde disminuido (C#dim7) es clave en "go together well".', criticalChord: 'C#dim7', chordType: 'M', steps: SCALE_STEPS['Jónica'], lyrics: `[Intro]\n[Fm][C][Fm][C]\n\n[Verso 1]\n[F]Michelle, [Gm7]ma belle\n[C]These are words that [C#dim7]go together [C]well\n[C#dim7]My Mi-[C]-chelle\n\n[Verso 2]\n[F]Michelle, [Gm7]ma belle\n[C]Sont des mots qui [C#dim7]vont très bien en-[C]-semble\n[C#dim7]Très bien en-[C]-semble\n\n[Puente]\n[Fm]I love you, I love you, I love you\n[Ab7]That's all I want to say\n[C7]Until I find a [Fm]way\nI will [Fm]say the [Eb]onlywords I [C]know that you'll understand\n\n[Verso 3]\n[F]Michelle, [Gm7]ma belle\n[C]Sont des mots qui [C#dim7]vont très bien en-[C]-semble\n[C#dim7]Très bien en-[C]-semble` },
            'here-today': { title: 'Here Today (Paul McCartney)', concertKey: 'G', baseChords: 'G–Bm–C–F', improvScale: 'G Mayor', advice: 'Corrección: Tonalidad Sol (G). La progresión usa acordes prestados como Fmaj7. Es una carta abierta a John Lennon.', criticalChord: 'C#dim7', chordType: 'maj7', steps: SCALE_STEPS['Jónica'], lyrics: `[Verso 1]\n[G]And if I said\nI really knew youwell\nWhat would your [C]answer be\nIf you were [Am]here to-day?\n[G]Ooh, ooh, [Em]ooh\n[Am]Here to-day\n\n[Verso 2]\n[G]Well, knowing you\nYou'd probably laugh andsay\nThat we were [C]worlds apart\nIf you were [Am]here to-day\n[G]Ooh, ooh, [Em]ooh\n[Am]Here to-day\n\n[Puente]\n[C]But as for me\n[F]I still remember how it was before\n[C]And I am holding back the tears no more\n[F]Ooh, [Em]ooh, [Am]ooh, I love you,ooh` },
            'in-my-life': { title: 'In my life (The Beatles)', concertKey: 'A', baseChords: 'A–E–F#m–Dm', improvScale: 'A Jónica', advice: 'El uso del Dm (iv menor) en una tonalidad mayor es el sello de nostalgia de los Beatles. Solo de piano barroco.', criticalChord: 'Dm (iv)', chordType: 'M', steps: SCALE_STEPS['Jónica'], lyrics: `[Verso 1]\n[A]There are [E]places [F#m]I re-[A7]member\nAll mylife, though [A]some have changed\n[A]Some for-[E]ever, [F#m]not for [A7]better\nSome havegone and [A]some remain\n\n[Pre-Estribillo]\n[F#m]All these places have theirmoments\n[G]With lovers and friends I [A]still can recall\n[F#m]Some are dead and some areliving\nIn mylife, I [A]love them all\n\n\n| A E | F#m A7 | D Dm | A |\n\n[Verso 2]\n[F#m]Though I know I'll never lose af-fection\n[G]For people and things that [A]went before\n[F#m]I know I'll often stop and think a-bout them\nIn mylife, I [A]love you more\nIn mylife, I [A]love you more` },
            'hotel-california': { title: 'Hotel California (Eagles)', concertKey: 'Bm', baseChords: 'Bm–F#7–A–E–G–D–Em–F#7', improvScale: 'B Menor Armónica / Pentatónica', advice: 'La progresión es única, casi un ciclo flamenco extendido. El solo final de guitarras armonizadas es historia pura.', criticalChord: 'F#7 (V)', chordType: 'm', steps: SCALE_STEPS['Armónica'], lyrics: `[Verso 1]\nOn a dark desert highway, [F#7]cool wind in my hair\n[A]Warm smell of colitas, [E]rising up through the air\n[G]Up ahead in the distance,I saw a shimmering light\n[Em]My head grew heavy and my sight grew dim\n[F#7]I had to stop for the night\n\n[Verso 2]\nThere she stood in the doorway; [F#7]I heard the mission bell\n[A]And I was thinking to myself, "This could be [E]heaven or this could be hell"\n[G]Then she lit up a candleand she showed me the way\n[Em]There were voices down the corridor, [F#7]I thought I heard them say...\n\n[Estribillo]\n[G]Welcome to the Hotel Cali-fornia\n[F#7]Such a lovely place (Such a lovely place)\nSuch a lovely face\n[G]Plenty of room at the Hotel Cali-fornia\n[Em]Any time of year (Any time of year)\n[F#7]You can find it here` },
            'band-on-the-run': { title: 'Band on the Run (Wings)', concertKey: 'D -> Am -> C', baseChords: 'Dmaj7-G (Parte 1), Am-D (Parte 2), C-F-G (Parte 3)', improvScale: 'C Jónica (Final)', advice: 'Corrección: Son tres canciones en una. Empieza balada en D/G, pasa a Rock en Am y libera en Folk en C. El cambio a C ("Well the rain...") es la liberación.', criticalChord: 'Fmaj7', chordType: 'm', steps: SCALE_STEPS['Eólica'], lyrics: `\nStuck inside these four walls\n[G6]Sent inside forever\nNever seeing no one nice a-gain [G6][Gm6]\n\n\n[Am]If I ever get out of here\nThought of giving it all away\n[Am]To a registered charity\nAll I need is a pint a day\nIf I ever get out of here... (Riff)\n\n\n[C]Well, the rain exploded with a mighty [Fmaj7]crash\n[C]As we fell into the sun\n[C]And the first one said to the second one [Fmaj7]there\n[Em]I hope you're having fun\n\n[Estribillo]\n[G]Band on the [C]run, [Em]band on the [C]run\n[F]And the jailer man and sailor Sam\n[F]Were searching every one\n[C]For the band on the [F]run, [C]band on the [F]run` },
            'quien-fuera-bunkers': { title: 'Quien Fuera (Los Bunkers)', concertKey: 'G', baseChords: 'G–Em–C–D', improvScale: 'G Mayor', advice: 'Corrección: Versión rockera de Los Bunkers. Tonalidad G. Intro icónica de guitarra eléctrica.', criticalChord: 'B7 (V del vi)', chordType: 'm', steps: SCALE_STEPS['Mayor'], lyrics: `[Intro]\n(Riff guitarra G - Em - C - D)\n\n[Verso 1]\n[G]Estoy buscando una [Em]palabra\n[C]En el umbral de tu mis-terio\n[G]Quien fuera Ali Ba-[Em]ba\n[C]Quien fuera el mítico sim-bad\n[G]Quien fuera un poderoso sor-[Em]tilegio\n[C]Quien fuera encanta-dor\n\n[Verso 2]\n[G]Estoy buscando una esca-[Em]fandra\n[C]Al pie del mar de los de-lirios\n[G]Quien fuera Jacques Cous-[Em]teau\n[C]Quien fuera Nemo el capi-tán\n[G]Quien fuera la batis-[Em]cafo de tu abismo\n[C]Quien fuera explora-dor\n\n[Estribillo]\n[G]Corazón, corazón os-[Em]curo\n[C]Corazón, corazón conmuros\n[G]Corazón que se es-[Em]conde\n[C]Corazón que estadónde\n[G]Corazón en [Em]fuga\n[C]Herido de dudas de a-mor` },
            'bad-moon-rising': { title: 'Bad Moon Rising (CCR)', concertKey: 'D', baseChords: 'D–A–G', improvScale: 'D Mayor', advice: 'Acordes D, A, G. El ritmo es rápido y cortado. Cuidado con el cambio rápido A-G en el verso.', criticalChord: 'G', chordType: 'M', steps: SCALE_STEPS['Mayor'], lyrics: `[Verso 1]\nI see the [A]bad [G]moon a-rising\nI see [A]trouble [G]on theway\nI see [A]earth-[G]quakes andlightning\nI see [A]bad [G]times to-day\n\n[Estribillo]\n[G]Don't go around tonight\nWell, it'sbound to take your life\n[A]There's a [G]bad moon on therise\n\n[Verso 2]\nI hear [A]hurri-[G]canes a-blowing\nI know the [A]end is [G]comingsoon\nI fear [A]rivers [G]overflowing\nI hear the [A]voice of [G]rage andruin\n\n[Estribillo]\n[G]Don't go around tonight\nWell, it'sbound to take your life\n[A]There's a [G]bad moon on therise` },
            'mala-bad-bunny': { title: 'Vete (Bad Bunny)', concertKey: 'Bbm', baseChords: 'Gbmaj7–Fm7–Bbm7', improvScale: 'Bb Menor', advice: 'Corrección: Basado en las letras "Lo nuestro ya se murió", la canción es "Vete". Usa acordes de Jazz/Neo-Soul: Gbmaj7, Fm7, Bbm7. Loop constante.', criticalChord: 'Gbmaj7', chordType: 'm', steps: SCALE_STEPS['Eólica'], lyrics: `[Intro]\n[Gbmaj7][Fm7]\nYeh, yeh, yeh, yeh\n\n[Estribillo]\n[Gbmaj7]Vete, eh, eh, eh\n[Fm7]Nadie te está aguantando y la puerta está a-bierta, eh\nNo te preocupes por nosotros dos, nuestra historia ya estámuerta\nEspero que seas feli-[Gbmaj7]z y que te diviertas, eh\n[Fm7]Pero pa' acá no vuelvas, no, no, no,no\nPorque lo nuestro ya se murió...` },
            'dont-let-me-down': { title: 'Don\'t Let Me Down (The Beatles)', concertKey: 'E', baseChords: 'E–B7–C#m–E7/D–A', improvScale: 'E Mixolidia / E Blues', advice: 'Blues-Rock lento. El acorde E7/D (dominante secundario) es el punto de color. Usar la escala Blues con el vibrato lento.', criticalChord: 'E7/D', chordType: 'M', steps: SCALE_STEPS['Blues'], lyrics: `[Verso 1]\n[E]Don't let me down\n[B7]Don't let me [C#m]down\n[E7/D]I'm in [A]love for the [E]first time\n[B7]Don't you know it's [E]gonna last` },
            'black-magic-woman': { title: 'Black Magic Woman (Santana)', concertKey: 'Dm', baseChords: 'Dm–Am–Gm–Dm', improvScale: 'D Menor Armónica', advice: 'El V dominante (A7) exige la D Menor Armónica (con C#) para el color flamenco/exótico. Prioridad al groove percusivo.', criticalChord: 'A7 (V Dominante)', chordType: 'm', steps: SCALE_STEPS['Armónica'], lyrics: `[Verso 1]\n[Dm]Got a black magic [Am]woman\n[Gm]Got a black magic [Dm]woman\n[Dm]I got a black magic [Am]woman, [A7]got me so [Dm]blind\n[Gm]Got a black magic [Dm]woman` },
            'gypsy-queen': { title: 'Gypsy Queen (Santana)', concertKey: 'D', baseChords: 'D–C–G/B–A', improvScale: 'D Mixolidia', advice: 'Instrumental que sigue a Black Magic Woman. Modula a Re Mayor. Ritmo más rápido y frenético.', criticalChord: 'D (Vamp)', chordType: 'M', steps: SCALE_STEPS['Mixolidia'], lyrics: `[Instrumental]\n(Transición rápida)\n\n| D | D | D | D |\n(Improvisación guitarra y percusión)\n\n[Final]\n[C][A]` },
            'sirius': { title: 'Sirius (Alan Parsons Project)', concertKey: 'Bm', baseChords: 'Bm–G', improvScale: 'B Menor', advice: 'Corrección: Tonalidad Bm. Intro icónica de los Chicago Bulls. Arpegio de Clavinet con Delay. Acordes simples Bm - G.', criticalChord: 'G', chordType: 'm', steps: SCALE_STEPS['Eólica'], lyrics: `[Instrumental]\n(Arpegio en Bm)\n\n| Bm | G | Bm | G |\n(Entran cuerdas y solo de guitarra eléctrica melódico)` },
            'eye-in-the-sky': { title: 'Eye in the Sky (Alan Parsons Project)', concertKey: 'Bm / D', baseChords: 'Bm–G–D–F#m', improvScale: 'D Mayor', advice: 'Sigue inmediatamente a Sirius. El estribillo usa Bm - G - D - F#m. La producción es cristalina.', criticalChord: 'Gm (iv menor)', chordType: 'm', steps: SCALE_STEPS['Jónica'], lyrics: `[Verso 1]\nDon't think sorry's easilysaid\nDon't try turning tables in-stead\n[G]You've taken lots of chances be-[Gm]fore\nBut I ain't gonna give any [Em]more\nDon't askme\nThat's how it [G]goes\n'Cause part of meknows what you're thinkin'\n\n[Estribillo]\nI am theeye in the sky, looking at [F#m]you\nI can read yourmind\nI am the maker of rules, dealing with [F#m]fools\nI can cheat youblind\nAnd I [G]don't need to see any [Gm]more\nTo know thatI can read your mind` },
            'golden-slumbers': { title: 'Golden Slumbers (The Beatles)', concertKey: 'Am / C', baseChords: 'Am7–Dm–G7–C', improvScale: 'C Mayor', advice: 'Parte de la suite de Abbey Road. Piano balada. Am7 abre, resuelve en C.', criticalChord: 'E7', chordType: 'M', steps: SCALE_STEPS['Jónica'], lyrics: `[Verso 1]\n[Am7]Once there was a way to get back homeward\n[Am7]Once there was a way to get back [G7]home\n[C]Sleep pretty darling, [Am]do not cry\n[G7]And I will sing a lulla-[C]by\n\n[Estribillo]\n[C]Golden [F]slumbers fill your [C]eyes\n[C]Smiles a-[F]wake you when you [C]rise\n[C]Sleep pretty darling, [Am]do not cry\n[G7]And I will sing a lulla-[C]by` },
            'carry-that-weight': { title: 'Carry That Weight (The Beatles)', concertKey: 'C', baseChords: 'C–G', improvScale: 'C Mayor', advice: 'Coro himno. Unísono vocal. C y G dominan.', criticalChord: 'G', chordType: 'M', steps: SCALE_STEPS['Jónica'], lyrics: `[Estribillo]\n[C]Boy, you're gonna [G]carry that weight\n[G]Carry that weight a long [C]time\n[C]Boy, you're gonna [G]carry that weight\n[G]Carry that weight a long [C]time\n\n[Verso]\n[C]I never give you my [Am]pillow\n[Am]I only send you my invi-tations\n[G7]And in the middle of the cele-[C]brations\n[Fmaj7]I break [G7]down` },
            'the-end': { title: 'The End (The Beatles)', concertKey: 'A (Solos) -> C (Final)', baseChords: 'A–D (Rock), C–F–G (Final)', improvScale: 'A Blues / C Mayor', advice: 'Duelo de guitarras (Paul, George, John) sobre A7-D7. Final majestuoso en Do Mayor.', criticalChord: 'F', chordType: 'M', steps: SCALE_STEPS['Jónica'], lyrics: `[Verso]\n[A]Oh yeah, all right\nAre you gonna be in my dreams\n[A]Tonight?\n\n\n\n\n| A7 | D7 | A7 | D7 | (x N veces)\n\n[Piano Intro Final]\n(Piano en acordes bloque)\n\n[Estribillo Final]\n[A]And in the end\n[G]The love you take\n[F]Is equal to the love\n[G7]You make [C]` },
            'coming-back-to-life': { title: 'Coming back to life (Pink Floyd)', concertKey: 'C', baseChords: 'C–Fmaj7–Am–G', improvScale: 'C Mayor', advice: 'Corrección: Tonalidad C Mayor. Intro etérea en C con sintetizadores. El solo de Gilmour es puro sentimiento sobre la progresión del verso.', criticalChord: 'Fmaj7', chordType: 'M', steps: SCALE_STEPS['Mayor'], lyrics: `[Verso 1]\n[C]Where were you when I was burned and [Fmaj7]broken?\n[Am]While the days slipped by [G]from my window [F]watching\n[C]And where were you when I was hurt and [Fmaj7]helpless?\n[Am]Because the things you say [G]and the things you [F]do surround me\n[Am]While you were hanging your-self on someone else's words\n[Am]Dying to believe inwhat you heard\n[Am]I was staring straight in-[G]to the shining [C]sun\n\n[Verso 2]\n[C]Lost in thought and lost in [Fmaj7]time\n[Am]While the seeds of life [G]and the seeds of [F]change were planted\n[C]Outside the rain fell dark and [Fmaj7]slow\n[Am]While I pondered on [G]this dangerous but irre-[F]sistible pastime\n[Am]I took a heavenlyride through our silence\n[Am]I knew the momenthad arrived\n[Am]For killing the past and [G]coming back to [C]life` },
            'just-the-two-of-us': { title: 'Just the Two of Us (Grover Washington Jr.)', concertKey: 'Fm (Dbmaj7 start)', baseChords: 'Dbmaj7–C7–Fm7–Ebm7–Ab7', improvScale: 'F Menor', advice: 'Corrección: Progresión de Jazz R&B clásica. Dbmaj7 - C7alt - Fm7 - Ebm7 - Ab7 (ii-V a Gb). Los acordes Ebm7 y Ab7 son esenciales para el movimiento.', criticalChord: 'C7alt', chordType: 'maj7', steps: SCALE_STEPS['Eólica'], lyrics: `[Verso 1]\nI see the crystal [C7]raindrops fall\n[Fm7]And the beauty of it [Ebm7]all [Ab7]\nIs when the sun [C7]comes shining [Fm7]through\nTo make those rainbows [C7]in my mind\n[Fm7]When I think of you some-[Ebm7]time [Ab7]\nAnd I want to spend [C7]some time with [Fm7]you\n\n[Estribillo]\nJust the two [C7]of us\n[Fm7]We can make it if we [Ebm7]try [Ab7]\nJust the two [C7]of us\n[Fm7]Just the two of us\nJust the two [C7]of us\n[Fm7]Building castles in the [Ebm7]sky [Ab7]\nJust the two [C7]of us\n[Fm7]You and I` },
            'aint-no-sunshine': { title: 'Ain\'t No Sunshine (Bill Withers)', concertKey: 'Am', baseChords: 'Am–Em–G–Am', improvScale: 'A Menor Pentatónica', advice: 'Minimalismo. La progresión Am - Em - G - Am es constante. El E7#9 o Em7 en el paso es clave.', criticalChord: 'Em7', chordType: 'm', steps: SCALE_STEPS['Pentatónica'], lyrics: `[Verso 1]\n[Am]Ain't no sunshine [Em]when she's [Am]gone\n[Am]It's not warm [Em]when she's [Am]away\n[Am]Ain't no sunshine [Em]when she'sgone\nAnd she's always gone too [Am]long\nAnytime she [Em]goes a-[Am]way\n\n[Verso 2]\n[Am]Wonder this time [Em]where she's [Am]gone\n[Am]Wonder if she's [Em]gone to [Am]stay\n[Am]Ain't no sunshine [Em]when she'sgone\nAnd this house just ain't no [Am]home\nAnytime she [Em]goes a-[Am]way\n\n[Puente]\nI know, I know, I know, I know... (x26)` },
            'smooth-operator': { title: 'Smooth Operator (Sade)', concertKey: 'Dm', baseChords: 'Dm7–Am7–Gm7–Am7', improvScale: 'D Menor Natural', advice: 'Corrección: Tonalidad Dm. La línea de bajo icónica se mueve sobre Dm7 - Am7 - Gm7 - Am7. Sofisticado y minimalista.', criticalChord: 'Gm7', chordType: 'm7', steps: SCALE_STEPS['Eólica'], lyrics: `[Verso 1]\nDiamond life, [Am7]lover boy\n[Gm7]We move in space with [Am7]minimum waste andmaximum joy\nCity lights [Am7]and business nights\n[Gm7]When you require [Am7]streetcar desire forhigher heights\n\n[Pre-Estribillo]\n[Gm7]No place for beginners or [Am7]sensitive hearts\n[Gm7]When sentiment is left to [Am7]chance\n[Gm7]No place to be ending but [Am7]somewhere to start\n[Gm7]No need toask\nHe's a smooth [Am7]operator\n[Gm7]Smooth [Am7]operator\nSmooth [Am7]operator\n[Gm7]Smooth [Am7]operator` },
        };

        let manualShift = 0;

        function getNoteIndex(note) {
            let baseNote = note.replace(/[^A-G#♭♯b]/g, '').trim().replace('♭', 'b').replace('♯', '#');
            const flatToSharp = { 'Db': 'C#', 'Eb': 'D#', 'Gb': 'F#', 'Ab': 'G#', 'Bb': 'A#' };
            baseNote = flatToSharp[baseNote] || baseNote;
            return NOTES.indexOf(baseNote);
        }

        function transposeNote(note, semitones) {
            let idx = getNoteIndex(note);
            if (idx === -1) return note;
            let newIdx = (idx + semitones) % 12;
            if (newIdx < 0) newIdx += 12;
            let newNote = NOTES[newIdx];
            const useFlat = note.includes('b') || ['F', 'Bb', 'Eb', 'Ab', 'Db', 'Gb'].includes(newNote);
            if (useFlat) {
                const flats = { 'A#': 'Bb', 'C#': 'Db', 'D#': 'Eb', 'F#': 'Gb', 'G#': 'Ab' };
                if(flats[newNote]) newNote = flats[newNote];
            }
            return newNote;
        }

        function getFullTransposedNote(fullChordStr, semitones) {
            const match = fullChordStr.match(/^([A-G][#b]?)(.*)$/);
            if(!match) return fullChordStr;
            return transposeNote(match[1], semitones) + match[2];
        }

        function generateChordNotes(root, type, semitones) {
            let idx = getNoteIndex(root);
            if(idx === -1) return [];
            let intervals = CHORD_INTERVALS[type] || CHORD_INTERVALS['M'];
            return intervals.map(i => NOTES[(idx + i + semitones) % 12]);
        }

        function drawGuitar(notes) {
            const W=200, H=140, FRETS=4, STRINGS=6;
            const fw = W/(FRETS+1), sh = (H-20)/(STRINGS-1);
            let s = `<rect x="5" y="10" width="${fw/2}" height="${H-20}" class="nut"/>`;
            for(let i=0; i<=FRETS; i++) { let x=5+fw/2+i*fw; s+=`<line x1="${x}" y1="10" x2="${x}" y2="${H-10}" class="fret-line"/>`; }
            for(let i=0; i<STRINGS; i++) { let y=10+i*sh; s+=`<line x1="5" y1="${y}" x2="${W-5}" y2="${y}" class="string"/>`; }
            for(let str=0; str<STRINGS; str++) {
                let openIdx = GUITAR_TUNING[str], y = 10 + str*sh;
                for(let f=1; f<=FRETS; f++) {
                    let note = NOTES[(openIdx + f) % 12];
                    if(notes.some(n => getNoteIndex(n) === getNoteIndex(note))) {
                        s+=`<circle cx="${5 + fw/2 + f*fw - fw/2}" cy="${y}" r="6" class="note-dot"/>`;
                    }
                }
            }
            return s;
        }

        function drawPiano(notes) {
            const keys = [{n:'C',t:0},{n:'C#',t:1},{n:'D',t:0},{n:'D#',t:1},{n:'E',t:0},{n:'F',t:0},{n:'F#',t:1},{n:'G',t:0},{n:'G#',t:1},{n:'A',t:0},{n:'A#',t:1},{n:'B',t:0},{n:'C',t:0},{n:'C#',t:1}];
            let s='', wx=0;
            keys.forEach(k => {
                if(k.t===0) {
                    let act = notes.some(n => getNoteIndex(n) === getNoteIndex(k.n));
                    s+=`<rect x="${wx*25}" y="0" width="25" height="100" class="${act?'highlight-key':'white-key'}"/>`;
                    wx++;
                }
            });
            wx=0;
            keys.forEach(k => {
                if(k.t===0) wx++;
                else {
                    let act = notes.some(n => getNoteIndex(n) === getNoteIndex(k.n));
                    s+=`<rect x="${(wx-1)*25+17.5}" y="0" width="15" height="60" class="${act?'highlight-key':'black-key'}"/>`;
                }
            });
            return s;
        }

        function changePitch(delta) {
            manualShift += delta;
            document.getElementById('pitch-val').innerText = (manualShift > 0 ? '+' : '') + manualShift;
            document.getElementById('pitch-bar').style.width = Math.min(100, Math.max(0, 50 + manualShift*4)) + '%';
            updateAnalysis();
        }

        function updateAnalysis() {
            const key = document.getElementById('song-selector').value;
            if(!key) return;
            const song = SONGS_DATA[key];
            const instShift = parseInt(document.querySelector('input[name="instrument"]:checked').value);
            const totalShift = instShift + manualShift;

            document.getElementById('initial-message').classList.add('hidden');
            document.getElementById('analysis-output').classList.remove('hidden');
            document.getElementById('right-panel-content').classList.remove('hidden');

            const rootKey = song.concertKey.split(' ')[0];
            const newKey = getFullTransposedNote(rootKey, totalShift);
            document.getElementById('transposed-key').innerText = newKey;
            
            const newChords = song.baseChords.replace(/([A-G][#b]?)([^–\s]*)/g, (m,r,s) => getFullTransposedNote(r+s, totalShift));
            document.getElementById('transposed-chords').innerText = newChords;

            const scaleRoot = song.improvScale.match(/^[A-G][#b]?/)[0];
            const scaleType = song.improvScale.replace(/^[A-G][#b]?\s*/, '');
            document.getElementById('transposed-scale').innerText = transposeNote(scaleRoot, totalShift) + " " + scaleType;
            
            document.getElementById('execution-advice').innerText = song.advice;

            if(song.lyrics) {
                document.getElementById('lyrics-content').innerHTML = song.lyrics.replace(/\[([A-G][#b]?)(.*?)\]/g, (m,r,s) => `<span class="chord-highlight">[${transposeNote(r, totalShift)}${s}]</span>`);
            }

            const scaleIdx = getNoteIndex(scaleRoot);
            let scaleNotesHTML = "";
            (song.steps || SCALE_STEPS['Natural']).forEach(s => scaleNotesHTML += `<span class="note-chip main-note">${NOTES[(scaleIdx+s+totalShift)%12]}</span>`);
            document.getElementById('scale-notes-container').innerHTML = scaleNotesHTML;

            const tonicNotes = generateChordNotes(rootKey, song.chordType, totalShift);
            document.getElementById('guitar-diagram-svg').innerHTML = drawGuitar(tonicNotes);
            document.getElementById('guitar-chord-name').textContent = newKey + (song.chordType === 'm' ? 'm' : '');
            
            document.getElementById('piano-diagram-svg').innerHTML = drawPiano(tonicNotes);
            document.getElementById('piano-chord-name').textContent = newKey + (song.chordType === 'm' ? 'm' : '');

            const critSection = document.getElementById('critical-chord-section');
            if (song.criticalChord && !song.criticalChord.includes('Ninguno')) {
                const critRoot = song.criticalChord.match(/^[A-G][#b]?/);
                let displayCrit = song.criticalChord;
                if(critRoot) {
                    let transCrit = transposeNote(critRoot[0], totalShift);
                    displayCrit = song.criticalChord.replace(critRoot[0], transCrit);
                }
                document.getElementById('critical-chord-advice').textContent = displayCrit;
                critSection.classList.remove('hidden');
            } else { critSection.classList.add('hidden'); }
        }

        const sel = document.getElementById('song-selector');
        Object.keys(SONGS_DATA).sort((a,b) => SONGS_DATA[a].title.localeCompare(SONGS_DATA[b].title)).forEach(k => {
            let opt = document.createElement('option'); opt.value = k; opt.innerText = SONGS_DATA[k].title; sel.appendChild(opt);
        });

        // THREE.JS ANIMATION
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({alpha:true, antialias:true});
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.getElementById('canvas-container').appendChild(renderer.domElement);
        
        const partGeo = new THREE.BufferGeometry();
        const pos = []; for(let i=0;i<800;i++) pos.push((Math.random()-0.5)*25, (Math.random()-0.5)*25, (Math.random()-0.5)*25);
        partGeo.setAttribute('position', new THREE.Float32BufferAttribute(pos, 3));
        const parts = new THREE.Points(partGeo, new THREE.PointsMaterial({color:0x00E5FF, size:0.03, transparent:true, opacity:0.6}));
        scene.add(parts);
        
        const geoWire = new THREE.IcosahedronGeometry(4, 1);
        const matWire = new THREE.MeshBasicMaterial({color:0x00E5FF, wireframe:true, transparent:true, opacity:0.07});
        const sphere = new THREE.Mesh(geoWire, matWire);
        scene.add(sphere);
        
        camera.position.z = 6;
        let mouseX = 0, mouseY = 0;
        document.addEventListener('mousemove', e => { mouseX = e.clientX - window.innerWidth/2; mouseY = e.clientY - window.innerHeight/2; });
        
        function animate() {
            requestAnimationFrame(animate);
            parts.rotation.y += 0.05 * (mouseX*0.001 - parts.rotation.y);
            parts.rotation.x += 0.05 * (mouseY*0.001 - parts.rotation.x);
            sphere.rotation.y += 0.002;
            renderer.render(scene, camera);
        }
        animate();
        window.onresize = () => { camera.aspect = window.innerWidth/window.innerHeight; camera.updateProjectionMatrix(); renderer.setSize(window.innerWidth, window.innerHeight); };
    </script>
</body>
</html>
