<script>
    document.addEventListener('DOMContentLoaded', function() {
        // ----- TRADUCCIONES (sin cambios) -----
        const translations = {
            es: { introText: 'Estos son algunos de los últimos proyectos del Laboratorio de Arte Generativo. Haz clic en cualquiera de ellos para verlos en acción.', catMusic: 'Videos Musicales', catShorts: 'Cortos Animados', catWeb: 'Páginas Web', catMusicProjects: 'Proyectos Musicales', ctaQuote: 'COTIZA TU PROYECTO' },
            en: { introText: 'These are some of the latest projects from the Generative Art Laboratory. Click on any of them to see them in action.', catMusic: 'Music Videos', catShorts: 'Animated Shorts', catWeb: 'Websites', catMusicProjects: 'Musical Projects', ctaQuote: 'QUOTE YOUR PROJECT' },
            fr: { introText: "Voici quelques-uns des derniers projets du Laboratoire d'Art Génératif. Cliquez sur l'un d'eux pour le voir en action.", catMusic: 'Vidéos Musicales', catShorts: "Courts métrages d'animation", catWeb: 'Sites Web', catMusicProjects: 'Projets Musicaux', ctaQuote: 'DEMANDEZ UN DEVIS' }
        };
        const elementsToTranslate = { introText: document.getElementById('intro-text'), catMusic: document.getElementById('cat-music'), catShorts: document.getElementById('cat-shorts'), catWeb: document.getElementById('cat-web'), catMusicProjects: document.getElementById('cat-music-projects'), ctaQuote: document.getElementById('cta-quote') };
        const langEnButton = document.getElementById('lang-en'), langEsButton = document.getElementById('lang-es'), langFrButton = document.getElementById('lang-fr');
        function setLanguage(lang) {
            const langData = translations[lang];
            Object.keys(elementsToTranslate).forEach(key => { if (elementsToTranslate[key]) elementsToTranslate[key].textContent = langData[key]; });
            langEnButton.classList.toggle('active', lang === 'en'); langEsButton.classList.toggle('active', lang === 'es'); langFrButton.classList.toggle('active', lang === 'fr');
            document.documentElement.lang = lang;
        }
        langEnButton.addEventListener('click', () => setLanguage('en')); langEsButton.addEventListener('click', () => setLanguage('es')); langFrButton.addEventListener('click', () => setLanguage('fr'));
        setLanguage('es');

        // ----- LÓGICA DE REPRODUCCIÓN CON VIMEO -----
        const gridItems = document.querySelectorAll('.grid-item');
        
        // Guarda el contenido original de cada item (la imagen y el icono)
        gridItems.forEach(item => {
            item.originalContent = item.innerHTML;
        });

        gridItems.forEach(item => {
            item.addEventListener('click', function() {
                // Comprueba si este item ya está reproduciendo un video
                const isPlaying = this.querySelector('iframe');

                // Resetea todos los items a su estado original (miniatura)
                gridItems.forEach(otherItem => {
                    otherItem.innerHTML = otherItem.originalContent;
                });

                // Si el item clickeado NO estaba reproduciendo, ahora pone el video.
                // Si SÍ estaba reproduciendo, el bucle anterior ya lo reseteó, por lo que actúa como un "stop".
                if (!isPlaying) {
                    const vimeoId = this.dataset.vimeoId;

                    // Procede solo si hay un ID de Vimeo válido
                    if (vimeoId) {
                        // URL optimizada para autoplay:
                        // &autoplay=1 -> Inicia automáticamente.
                        // &muted=1 -> NECESARIO para que autoplay funcione en la mayoría de navegadores. El usuario puede quitar el mute manualmente.
                        // &title=0&byline=0&portrait=0 -> Oculta el título, autor y avatar para un look más limpio.
                        const embedUrl = `https://player.vimeo.com/video/${vimeoId}?autoplay=1&muted=1&title=0&byline=0&portrait=0`;
                        
                        // Creamos el iframe con los atributos necesarios
                        const iframe = document.createElement('iframe');
                        iframe.src = embedUrl;
                        iframe.style.width = '100%';
                        iframe.style.height = '100%';
                        iframe.setAttribute('frameborder', '0');
                        iframe.setAttribute('allow', 'autoplay; fullscreen; picture-in-picture');
                        iframe.setAttribute('allowfullscreen', '');

                        // Limpiamos el item y añadimos el iframe del video
                        this.innerHTML = '';
                        this.appendChild(iframe);
                    } else {
                        console.log("Este item no tiene un ID de Vimeo asociado.");
                    }
                }
            });
        });
    });
</script>
